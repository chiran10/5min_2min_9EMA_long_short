//This Pine Script v6 strategy named "5min_2min_9EMA_long_short" is designed for TradingView to generate long and short trade entries based on 
//the interaction of price with specific exponential moving averages (EMAs) and VWAP during a defined session window in the New York time zone. 
//Additionally, it tracks and alerts on daily price percentage gains crossing key thresholds relative to the previous day's close.


//@version=6
strategy("5min_2min_9EMA_long_short", overlay=true)

// Session time in EST (New York)
startHour = 9
startMinute = 45
endHour = 12
endMinute = 0

// Check if current bar time is within session
inSession() =>
    h = hour(time, "America/New_York")
    m = minute(time, "America/New_York")
    (h > startHour or (h == startHour and m >= startMinute)) and (h < endHour or (h == endHour and m < endMinute))

// 9 EMA on 2-minute and 5-minute timeframes
ema9_2m = request.security(syminfo.tickerid, "2", ta.ema(close, 9))
ema9_5m = request.security(syminfo.tickerid, "5", ta.ema(close, 9))

// VWAP (current chart)
vwapValue = ta.vwap(close)

// Previous day's close (correct: close[1] on daily)
prevDayClose = request.security(syminfo.tickerid, "D", close[1], lookahead=barmerge.lookahead_on)
priceChangePercent = 100 * (close - prevDayClose) / prevDayClose

// Thresholds for alerting
thresholds = array.new_float()
array.push(thresholds, 50)
array.push(thresholds, 100)
array.push(thresholds, 125)
array.push(thresholds, 150)
array.push(thresholds, 175)
array.push(thresholds, 200)

for i = 0 to array.size(thresholds) - 1
    threshold = array.get(thresholds, i)
    if priceChangePercent > threshold
        alert("PRICE GAIN ABOVE " + str.tostring(threshold) + "%: Current gain=" + str.tostring(priceChangePercent, "#.##") + "%")

// Conditions
priceAboveEMA = close > ema9_2m and close > ema9_5m and close > vwapValue
priceBelowEMA = close < ema9_2m and close < ema9_5m

// Entry Long (ENTER regardless of current position)
if inSession() and priceAboveEMA
    strategy.entry("Long", strategy.long)
    alert("LONG ENTRY: Price > 9 EMA on 2m,5m,VWAP")

// Entry Short (ENTER regardless of current position)
if inSession() and priceBelowEMA
    strategy.entry("Short", strategy.short)
    alert("SHORT ENTRY: Price < 9 EMA on 2m,5m")
